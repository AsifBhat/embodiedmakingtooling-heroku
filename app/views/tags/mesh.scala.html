<!DOCTYPE html>
<title>D3 HexBinning</title>
<meta charset="utf-8">
<style>

.mesh {
  fill: none;
  stroke: #000;
  stroke-width: .25px;
}

.start {
  fill: none;
  stroke: brown;
}

.end {
  fill: none;
  stroke: steelblue;
}

#container{
  border: 1px solid #D0D0D0;
  overflow-y: scroll;
  margin: -2%;

}

body{
  overflow: hidden;
}

.pullMeshUp{
  margin-top: -5px;
  /*padding-top: 5px;*/
}

#testCont{
  height: 100%;
}

</style>
<div id="container">
  <div id="grid"></div>
</div>
<br>
<script src="javascripts/d3.v3.min.js"></script>
<!-- <script src="js/d3.hexbin.v0.min.js"></script> -->
<script src="javascripts/hexbin.js"></script>
<!-- <script src="http://d3js.org/d3.interpolate-zoom.v0.min.js?83165af"></script> -->
<script src="javascripts/jquery-1.9.0.min.js"></script>
<script>
var scrollJqueryObj = null;
var gridHeight = 0, width=0, height = 0, radius = 0;
var svgObj = null;

$(document).ready(function(){
  // code to create mesh work
  init();
  createMesh();
  // mesh creation ends


});

function init(){
  radius = 25;
  height = radius*30 ;
  $('#container').height(height);
  //gridHeight = height;

  width = (window.innerWidth * 1.2) ;
};

function createMesh(){
  //init();
  svgObj = d3.select("#grid")
    .append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g");
     // .call(transition, p0, p1);
  var hexbin = d3.hexbin();
   
  svgObj.append("path")
    .attr("class", "mesh")
    .attr("d", 
      hexbin.size([width, height])
        .radius(radius)
        .mesh);
};

function eventRunning(event){
  event.preventDefault();
  console.log();
}

var pathObj = null; //test var: to be removed
//drawMesh
function appendMesh(){
  svgObj = d3.select("#grid")
    .append("svg")
    .attr("width", width)
    .attr("height", height)
    .attr("class", "pullMeshUp")
    .append("g");
     // .call(transition, p0, p1);
  var hexbin = d3.hexbin();
   
  svgObj.append("path")
    .attr("class", "mesh")
    .attr("d", 
      hexbin.size([width, height])
        .radius(radius)
        .mesh);
}

  $("#container").scroll(function() {
    if (this.offsetHeight + this.scrollTop >= this.scrollHeight) {
      //scrolledToBottom(e);
      console.log('scroll ended');
      //scrollJqueryObj = this;
      //appendMesh();
      appendMesh();
    }
  });

</script>